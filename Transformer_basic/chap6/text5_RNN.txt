304p
순환 신경망 모델은 순서가 있는 연속적 데이터를 처리하는데 적합하다.
각 시점의 데이터가 이전 시점의 데이터와 독립적이지 않다는 특성 때문에 효과적으로 작동.

연속형 데이터는 주가와 같이 t시점의 데이터가 이전 시점 t0에 영향을 받는 데이터

--
긴 문장일수록 앞 단어와 뒷 단어 사이에 강한 상관관계가 존재한다고 한다.

순환신경망: 연속형 데이터를 처리하기 위해 개발된 인공신경망의 일종
이전에 처리한 데이터를 다음 단계에 활용하고
현재 입력 데이터와 함께 모델 내부에서 과거의 상태를 기억해
현재 상태를 예측하는데 사용

306p
시계열 데이터, 자연어 처리, 음성 인식 및 기타 시퀸스 데이터와 같은 도메인에서 순환신경망이 널리 사용되는 이유는
이들이 대체로 가변적이며, 순서에 따라 의미가 있기 때문이며 이를 처리하기 위해 적합한 구조가 있다.

연속형 데이터를 순서대로 입력받아 처리하며
각 시점마다 은닉 상태의 형태로 저장
각 시점의 데이터를 입력으로 받아 은닉 상태와 출력값을 계산하는 노드를 셀(Cell)이라 한다

순환 신경망의 셀은 이전 시점의 은닉 상태 h_t-1을 입력으로 받아 은닉 상태 h_t를 계산

은닉 상태에 관한 식
h_t = σ(h_t-1, x_t)
h_t = σ(W_hh*h_t-1 + W_xh*x_t + b_h)
W_hh: 이전 시점의 은닉 상태 h_t-1에 대한 가중치
W_xh: 입력값 x_t에 대한 가중치
b_h: 은닉상태 h_t의 편향
σ_h: 은닉 상태를 계산하기 위한 활성화 함수

출력값에 관한 식
y_t = σ_y(h_t)
y_t = σ_y(W_hy*h_t + b_y)
σ_y는 순환 신경망의 출력값을 계산하기 위한 활성화 함수, 현재 시점의 은닉상태 h_t를 입력으로 받아 출력값 y_t를 계산
W_hy: 현재 시점의 은닉 상태 h_t에 대한 가중치
b_y: 출력값 y_t의 편향

307p
순환 신경망은 일대다 구조/다대일 구조/다대다 구조가 있다고 한다

일대다 구조: 하나의 입력 시퀀스에 여러 개의 출력값을 생성하는 RNN 구조
ex) 문장에서 각 단어의 품사를 예측하는 작업, 이미지-> 이미지에 대한 설명(문장'들')을 출력하는 이미지 캡셔닝 모델

일대다 구조를 구현하기 위해서는 출력 시퀀스의 길이를 미리 알고 있어야한다.
이를 위해 입력 시퀀스를 처리하면서 시퀀스의 정보를 활용해
시퀀스의 길이를 예측하는 모델을 함께 구현해야한다
???

---
다대일 구조: 여러 개의 입력 시퀀스에 하나의 출력값을 생성하는 RNN 구조
ex) 감성분류모델은 여러 문장으로 해당 문정의 감정을 출력
문장분류, 자연어 추론에도 사용가능

---
다대다 구조: 입력 시퀀스와 출력 시퀀스의 길이가 여러 개인 경우에 사용하는 RNN구조
ex) 번역기, 음성 인식 시스템
Seq2Seq 구조로 이뤄지고 해당 구조에서 인코더는 입력 시퀀스를 고정 크기의 벡터로 출력, 디코더는 이 벡터로 출력 시퀀스를 생성

------
양방향 순환 신경망: 기본적인 순환 신경망에서 시간 방향을 양방향으로 처리할 수 있게 고안된 방식
이전 시점의 은닉 상태뿐아니라 이후 시점 즉 t-1/t+1의 은닉 상태를 같이 이용하는것
??? 인생은 B와 _사이의 C다. 라는 문장에서 _를 예측하기 위한 방식
(그림에서는, 입력값이 2개의 RNN 셀에 각각 들어감)

---
다중 순환 신경망: 여러 개의 순환 신경망을 연결하여 구성한 모델, 각 순환 신경망이 서로 다른 정보를 처리하도록 설계
여러층으로, 한 층의 출력은 다음층으로 전달
(그림에서는, 입력값이 RNN 셀에 들어가고, RNN 셀에서 다른 순환신경마의 RNN 셀로 들어감)
학습이 오래 걸리고 기울기 소실이 발생할 가능성있다고한다.

311p
파이토치 안에 순환 신경망 클래스 제공
torch.nn.RNN(
    input_size, # 입력 특성 크기
    hidden_size, # 은닉 상태 크기
    num_layers=1, # 계층 수, 2개 이상이면 다중 순환 신경망
    nonlinearity="tanh", # 활성화함수, 아마 비선형함수라 저렇게 써둔듯
    bias=False, # 편향 값 사용 유무
    batch_first=True, # 입력 배치 크기를 첫 번째 차원으로 사용할것인지, True는 [배치크기, 시퀀스길이, 입력특성크기]고 False면 배치랑 시퀀스 자리가 바뀐다
    dropout=0, # 말그대로 규제인 드롭아웃
    bidirectional=False # 양방향 순환 신경망인가?
)

https://wikidocs.net/22886