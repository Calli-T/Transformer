오레일리 책의 기초 정보
표본 공간: (샘플) x가 가질 수 있는 모든 값의 집합
모수 모델링: (샘플에 대한) 밀도 함수 P_model(x)를 찾는 기술 -> 아마 사후 통계를 바탕으로 확률 밀도 함수를 찾는 기술인듯

확률 밀도 함수는 연속 확률 변수를 나타내는 함수

--------------------------
에센셜 통계학 서적의 기초 내용
91p
조건부 확률의 개념과 그 식이란란?
B가 주어졌을 때 A의 조건부 확률은 P(A|B)로 나타낸다
그리고 그 값은 다음의 식으로 나타냄 P(A|B) = P(A∩B) / P(B) <-> P(A∩B) = P(B) * P(A|B)
※ 조건부 표기에서 주어진게 오른쪽이더라, 맨날 헷갈림..., 그리고 분모에 주어진게 내려간다!
※ 주어진 사건확률이 분모, 합사건(교집합)이 분자!

97p
총확률의 법칙이란?
사건 A가 일어날 확률은 A와 B가 모두 일어날 확률과, A가 일어나고 B가 일어나지 않은 확률의 합과 같다.
저걸 조건부 확률식으로 바꾸면
P(A) = P(A∩B) + P(A∩~B) = P(A|B)P(B) + P(A|~B)P(~B)

99p
P(A)나 P(B)는 사전확률
조건부 확률 두 개를 P(A|B)와 P(A|~B)를 알고 있다면, A의 상태를 관찰하여 B의 확률을 갱신할 수 있다... 고한다
사건 A가 발생했을 때 사건 B의 갱신된 사후확률은 P(B|A) = P(A∩B) / P(A)
이를 총확률의 법칙과 조건부 확률의 식으로 바꾸면
P(B|A) = P(A∩B) / P(A) = P(A|B)P(B) / (P(A|B)P(B) + P(A|~B)P(~B))

책의 예제
바이러스에 감염되었을 확률 P(B) = 0.014, P(A|B) = 0.995, 양성일 확률 P(A)로 표기
바이러스에 감염되지 않았으나(~B) 양성반응이 나올 경우(A)는  P(A|~B)이며 0.01
P(A) = P(A|B)P(B) + P(A|~B)P(~B)
P(A) = 0.995*0.014  + 0.01*0.986 = 0.02379
그렇다면 양성반응이 나왔을 때 바이러스에 감염되었을 확률은?
양성 반응이 A, 바이러스에 감염된것이 B면 P(B|A)를 구하면된다
P(B|A) = P(AB) / P(A) = P(A|B)P(B) / (P(A|B)P(B) +P(A|~B)P(~B)) = 0.01393 / (0.01393 + 0.01*0.986) = 0.585549143 약 58.6%
감염되었을 때 양성반응일 사후확률을 P(A|B)라하면, 우도 즉 양성반응인 것을 증거로 채택할 때 감염되었을 확률은 58.6%이다

--------------------------

https://blog.naver.com/PostView.naver?blogId=ycpiglet&logNo=223110695364
이 사이트에서 참고한 내용(이거 내용을 교차검증을 한 번 해봐야겠는데?)

P(A|B): 사후확률(A Posterior Probability, A posteriori) ※ 즉 사건 B가 일어난 것을 알 때 사건 A의 갱신된 확률 이라할 때
P(A): 사전확률(Prior Probability, A priori)
P(B): 증거/정규화 상수/주변가능도 등...
P(B|A): 우도(= 가능도)

우도는 사건이 발생 했을 때 증거의 확률이다, 사후확률에서 증거와 사전확률의 위치를 반대로한듯

책의 내용과 섞어 봤을 때, P(A|B)와 P(A|~B)를 알면 A를 상태를 관찰 했을 때 B의 확률을 갱신할 수 있다고 한다
실제로 P(B|A)를 베이즈 정리 식으로 나타내면 P(A|B)P(B) / (P(A|B)P(B) + P(A|~B)P(~B))으로 둘 다 사용됨

확률을 확률질량함수와 확률밀도함수로 나눌 수 있는데, 위는 이산확률 즉 확률질량함수의 값으로 나타낼 수 있다.
정규분포의경우, X의 값이 어느 구간에 있는지를 따지는 것
P(a<= X <= b) 확률변수가 뭐 이런식이다

-----

뭔가 정리가 덜 된 내용
(확률밀도함수도 우도를 계산할 수 있다!
정규분포에서 평균과 분산 즉 분포의 형태를 결정짓는 '파라미터'가 주어진 상태에서(이건 다른 분포도 마찬가지인가?, 일단 정규분포의 경우 μ랑 θ를 쓴다)
f(x) = f(x|θ) = f(X=x|μ, θ)

파라미터 θ를 고정시켜놓고 거기서 X의 값만 변한다
f(x) = (1/(σ*2π^0.5))^(e^(-1/2*((x-μ)/σ)^2)) <- 이게 정규분포 식이고
어떤 분포가 정해졌을 때 분포에 따르면 이 표본이 나올 확률이 얼마나 되는지를 따지는 것이 확률밀도함수에서의 확률
반대로, 데이터가 구해졌다면 이것이 변하지 않으므로 패러미터 θ를 찾는 것이 (연속확률분포에서의) 가능도의 개념

데이터가 주어졌을 때 사후확률은 P(θ|x) 뭐 이런식이라면
우도는 반대로 P(x|θ)인듯)

-----

(분포가 여러개 주어졌고, 사후확률은
f(θ_1|x) = f(μ=0, σ=1 | X=3)
f(θ_2|x) = f(μ=-1, σ=0.5 | X=3)
f(θ_3|x) = f(μ=4, σ=-2 | X=3)
뭐 이런식으로 서로 다른 패러미터를 가진 분포가 존재한다고 하자
그럼 데이터가 어떤 분포에서 도출된 것이 가장 타당한지 확인해보려면,
확률이 가장 큰 사후 확률의 분포(패러미터)가 가장 합리적일 것이다

각 패러미터 θ에서 가장 타당한 θ즉 θ_hat을 구하기 위해서는
argmax f(θ|x)를 한다 즉 데이터가 주어졌을 때 사후확률 중에서 가장 높은 값을 나타내는 패러미터를 찾아내면된다

이를 최대 사후분포(Maximum A Posteriori, MAP)이라한다.
즉, 최대 사후 분포는 f(θ_i | x)중 가장 큰 값을 고르는 것
??? -> 이거 나중에 예제 한 번 찾아봅시다) -> 나중에 개념 머리에 다시 좀 넣어봅시다

-----

https://pasongsong.tistory.com/369
https://chatgpt.com/c/7e3acfec-7d16-4e3b-a6e9-7734d4732da3

최대 우도법은 최대우도로 확률 분포를 추정하는 방법이다.

최대우도법 즉 Maximum Likelihood estimation, MLE는 다음의 3단계로 이루어진다
1. 우도 함수 설정
2. 로그 우도 함수로 변환
3. 로그 우도 함수를 평균과 표준편차에 대하여(※ 정규 분포의 매개변수이다) 편미분하고, 결과가 0인 값을 찾는다

1. 우도 함수 설정
서로 독립인 데이터가 N개 있을 때 우도 함수는
L(μ, σ|X_1, X_2,...,X_n)
= Π_product(i=1, n, f(X_i|μ, σ))
= Π_product(i=1, n, (1 / sqrt(2πσ^2) * e^(-((X_i-μ)^2/2σ^2))) )
즉, 우도함수는 각 데이터 포인트의 확률 밀도 함수의 곱으로 표현된다.

※ 정규분포의 확률 밀도 함수는 다음과 같다 f(x|μ, σ) = (1 / sqrt(2πσ^2) * e^(-((X_i-μ)^2/2σ^2))
※※ 우도 함수는 데이터 각각의 우도 p(x|θ)의 곱이다. 독립인 데이터가 동시에 일어날 전체 가능성의 표현이기 때문이다. ( 독립인 사건 A와 B에 대해 P(A∩B)=P(A)×P(B) )
※※※ 데이터에서 분포를 뽑아내는 것이기 때문에 위 식에서 X_i는 상수이고 μ, σ가 매개변수이다

2. 로그 우도 함수로 변경
확률은 [0, 1]사이의 값이기 때문에 곱하면 값이 0에 가까워진다. 우도 함수가 그러하다
따라서 함수에 로그를 씌워 로그 우도로 바꾼다.
log L(μ, σ|X_1, X_2,...,X_n) = log(Π_product(i=1, n, (1 / sqrt(2πσ^2) * e^(-((X_i-μ)^2/2σ^2)) ))
로그의 진수끼리의 곱셈 -> 덧셈 성질을 적용하면
log(Π_product(i=1, n, (1 / sqrt(2πσ^2) * e^(-((X_i-μ)^2/2σ^2)) ))
= Σ_sum(i=1, n, log( (1 / sqrt(2πσ^2)) * e^(-((X_i-μ)^2/2σ^2)) ) ))
= Σ_sum(i=1, n, log(1 / sqrt(2πσ^2)) + log(e^(-((X_i-μ)^2/2σ^2))) ))
= Σ_sum(i=1, n, -0.5 * log(1/2πσ^2) + (-((X_i-μ)^2/2σ^2)) )) ※sqrt는 0.5제곱이고 분모에 있으므로 마이너스, 로그 밖으로 -0.5를 빼낸다 / log(자연로그를 밑으로함)와 exp(자연로그의 제곱)는 역함수, 서로 상쇄

따라서 로그 우도 함수 L은 다음과 같다
log L(μ, σ|X_1, X_2,...,X_n) = Σ_sum(i=1, n, ( -0.5 * log(2πσ^2) - (X_i-μ)^2 / 2σ^2 ) ) ※ 3번째 매개변수는 데이터 각각의 로그 우도 그 자체

※ 로그 함수는 단조(=주어진 순서를 보존)증가함수이므로, 미분 했을 때 극값을 가지는 위치가 변하지 않는다고한다.
즉, 우도함수가 제일 큰 값을 가질 때(= 미분해서 극값이 나올 때) log우도도 제일 큰 값을 가진다고 한다.
※※ log(a * b) = log(a) + log(b) 즉 두 수의 곱에 로그를 취하면 각각의 수에 로그를 취한 값의 합과 같다.
우도 함수가 각각의 우도의 곱이므로, 로그를 씌우면 로그 우도의 합으로 바뀐다.

3. 로그 우도를 최대화하는 평균과 표준편차 찾기
로그 우도를 단순화하면
Σ_sum(i=1, n, ( -0.5 * log(1/2πσ^2) - (1/2σ^2) * (X_i-μ) ) )가 된다.

이를 μ으로 편미분 하면
∂/∂μ log L(μ, σ) = (1/σ^2) *  Σ_sum(i=1, n, (X_i-μ))이다.
이를 풀면, μ에 대한 최대 우도 추정치 μ_hat은 극값 즉 도함수가 0이 되는 구간이다
(1/σ^2) *  Σ_sum(i=1, n, (x_i-μ_hat)) = 0 ※ 식을 준다면
<-> Σ_sum(i=1, n, x_i) - nμ_hat은 = 0  ※ 상수항 (1/σ^2)는 무시하고 시그마 안의 내용을 둘로 나눔
<-> 1/n * Σ_sum(i=1, n, x_i) = μ_hat
즉 μ_hat은 데이터의 평균이다
※ μ의 편미분 과정에서 -0.5 * log(1/2πσ^2)는 데이터에 무관하게 고정 값이므로 상수로 취급
나머지는 최적의 모수 값을 찾아내는데 필요하므로 데이터항으로 취급

한편 로그 우도 함수를 σ으로 편미분 하면
y = log e x를 미분했을 때
∂/∂σ log L(μ, σ)
= -0.5n * (4πσ/2πσ^2) - 0.5 * (-2) * (1 / σ^3) * Σ_sum(i=1, n, (X_i-μ)^2)
= -n/σ + (1 / σ^3) * Σ_sum(i=1, n, (X_i-μ)^2)

이 도함수의 값이 0이 되는 극값을 찾으면
-n/σ + (1 / σ^3) * Σ_sum(i=1, n, (X_i-μ)^2) = 0
<-> n/σ = (1 / σ^3) * Σ_sum(i=1, n, (X_i-μ)^2)
<-> σ^2 = (1/n) * Σ_sum(i=1, n, (X_i-μ)^2)
이 때 분산의 값은 데이터의 분산의 값으로 나온다

즉, 정규분포에서 나온 데이터를 통한 최대 우도 추정을 통한 가장 타당한 평균과 표준 편차는,
데이터의 평균과 분산의 값을 통해 나온 정규분포이다.