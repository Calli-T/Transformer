ema를 토치로 구현해둔게 존재한다
https://github.com/lucidrains/ema-pytorch

평균/표준편차로 비정규화 하는과정에서 해당값은 IMAGENET의 국룰 값을 따르는 방법이 있고
그 값은 mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]이다.
이 디렉터리의 예시는 그냥 데이터셋의 평균과 표준편차를 따로 계산해뒀다가 따른다

추정하기로는, 어짜피 손실함수의 값에 따라 곱해지는 수가 최적화 될것이므로 국룰값도 적당히 가능한듯하다

ddpm 모델에서 '학습'이 이뤄지는것 U-Net 뿐이다
실제로 forward 함수도 U-Net(혹은 이를 카피한 EMA U-Net)뿐
그렇다면, ddpm 클래스가 nn.Module일 필요가 있는가? 그렇지는 않다!
이전의 토치예제들에서 모델 클래스를 선언하고 학습은 밖에서 했다

그렇다면 ddpm 클래스가 클래스로 만들어진 이유는 무엇인가?
반드시 그럴 필요가 없지만, 내수용 메서드와 필드로 구분하기 좋기 때문이다
그건 unet이나 ema-unet을 안에 둘 다 가지고 있어야하고,
함수들이 mean과 std등등을 사용하기 때문이다
역방향 확산 과정의 diffusion time등은 매개변수가 아니라 클래스 내부 변수로 바꿔도 괜찮을듯?
클래스 고유의 하이퍼 파라미터로 가지는것이다

그렇다면, 학습해야할 모델(클래스)가 다른 클래스 안에 있다면,
학습용 함수도 클래스의 메서드로 넣어버리면 그만이 아니겠는가?