베이스 모델 제작중
일단 Aug 가본다
데이터셋은 AI-HUB에서 제공하는 아나운서(와 지망생)의 뉴스보도 데이터를 사용한다
https://aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=data&dataSetSn=71557


이거 처음 알게된 사실인데, f0에 패딩까지 넣은거로 고려하기 때문에, (다시 패딩안하려고)
처음 세팅한 sentence(학습용 배치크기)를 따라가야하며 안그러면 버그난다

해결해야할 문제
1. 버그 수정
이거 처음 알게된 사실인데, f0에 패딩까지 넣은거로 고려하기 때문에, (다시 패딩안하려고)
처음 세팅한 sentence(학습용 배치크기)를 따라가야하며 안그러면 버그난다
고치려면?
이거 f0를 npz로 저장해서 각각을 패딩 없이 전부 저장하던지 해야한다

이거 일단 생각해볼점
{ 잠깐 집어치워놓고 생각
    f0파일은 44.1 kHz SR, mono channel, 16 bit PCM, wav파일을
    약 5시간어치, 1.6 GiB의 정보를 꺼내도 17 MiB밖에 안한다
    결론1: 그냥 한 파일에 다 때려박는게 가능하면 그렇게 하자
    f0를 만드는건 좋은데 무수한 파일들이 감당이 안되니 2개만 꺼내서 테스트해보자
    저장할 때의 f0와, 이를 꺼내어 처리하는 코드를 모두 생각해둬야한다
    f0저장해두는건  infer쪽말고 train쪽만 고민하면되긴하다
    저장할 때의 대략적인 순서는 다음과 같다
    1. 여러수를 써서 sublist의
}
결국 문제는 저장할 때 배치단위로 패딩하고,
그 방식이 배치에서 가장 큰 길이에다 맞추는 것이라 문제이면
원래의 f0를 그대로 저장하면 될 문제아닌가?
원래부터 음원의 f0는 npy로 각각 저장이었다.
그럼해결되는가?
아니다!
f0가 패딩이 안된 상태라 패딩을 해줘야한다
심지어 패딩된 mel에 수행하는거라 자동 패딩이다!
결론:
1. 패딩안한 f0저장
2. 불러올 때 패딩
-> 해결됨

2. Validation도 만들어 두긴해야한다
이거 일단 생각해볼점
val도 f0의 npy(혹은 npz)파일화, 음원 커팅을 따로 하느니,
결론1: dataset전체의 일부를 val로 쓰는 방식을하자
그리고 고정 val을 쓸것인가? K fold/holdout 등의 교차검증을 쓸것인가?
결론2: 일단 holdout을 무작위로 계속 섞는 방식을 쓰자
그리고 eval모드 train모드 키고 끄는거랑, with torch어쩌고 잘구현해두자

+) minmax spec은 denoise모델 학습이랑은 딱히 상관없으니 통합해서 두자

3. embedding 모델에 안쓰는 레이어 들어간거 회수해야하지않나
-> 코드에 주석만 씌우면됨, 애초에 쓰는 곳이 없음
->-> 신창섭 모델은 사용불가능해짐 이러면, 나중에 devide_model 코드로 다시 뽑아야함
->->-> devide_model 코드의 state_dict 거르는 코드에서 mel_out 계층은 한 줄 빼야함

4. 음원자르는거 대체 뭘 기준으로 하는건지 알아야함

5. epoch단위로 저장하는거 step단위로 저장할지 고민한 번 해보긴 해야함
-> 일단 epoch단위로 하자, steps가 나을것같긴한데, 얼마나 학습한지 모르는건 매한가지다

6. adamw도 저장을 해야한다
-> 했다