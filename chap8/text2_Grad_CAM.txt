Grad-CAM는 설명 가능한 인공지능중 하나
블랙 박스 문제를 해결하기 위한 방법중 하나이다

설명 가능한 인공지능은 모델 내부의 동작 방식을 분석하여 결과를 해석하고 동작 방식을 설명하는 방법 제공
또한 모델의 신뢰성을 알아보고 결과를 수정하거나 개선하는데 사용가능


※ 클래스 활성화 맵(Class Activation Map, CAM): 설명가능한 인공지능의 하나,
딥러닝 모델에서 특정 클래스와 관련된 입력 이미지 영역을 시각화하는 방법
CNN에서 주로 사용된다.

492p의 그림은 히트맵으로, 이미지 영역별로 특정 클래스로 분류하는 모델이 주목하는 정도를 나타냈다

493p
CAM map은 CNN의 특징 맵의 채널과 분류기의 매개변수 값을 활용해 생성된다.
특징맵의 각 채널과 분류기의 가중치를 곱해 채널마다 가중치의 합을 계산 ->
해당 값을 정규화하여 강하게 활성화 되는 영역을 수치화 ->
이를 시각화하여 표현

CNN의 마지막 Conv layer는 특징 맵을 계산하는 계층이라고한다
이 층에서 Global Average Pooling을 적용해서
각 픽셀에 대한 정보를 1차원으로 펴고 이를 출력으로 사용한다

GAP를 통과하면서 특징 맵의 채널 별로 특징값을 통합하고 ->
이 값을 분류기에 전달한다 ->
이 때 사용된 분류기의 매개변수가 출력 클래스에 대한 특징값 가중치
???

가중치가 높을수록 분류에 많은 영향,
가중치가 낮을수록 분류에 적은 영향,
따라서 GAP를 통해 CNN이 각 클래스에
어떤 특징을 활용해 분류를 수행하는지 확인가능,
시각화도 가능

이거 한 번 다시보고 CAM과 Grad-CAM을 보자

494p
가중치를 특징 맵에 전달하는 방법을 알려주는 수식
L-c(i,j) = (from k)Σw_k-c*f_k(i, j)

L(윗첨자)c: 클래스 활성화 맵의 출력값
i: 행
j: 열
W(윗첨자)c(아랫첨자)k: 클래스 c에 대한 채널의 특징 맵 분류 가중치
f(아랫첨자)k(i,j): 특징 맵 k번째 채널의 i행 j열 값

w_k-c와 f_k(i, j)의 곱은
클래스 c를 계산하기 위한
채널별 이미지 영역의 주요 특징계산,
이를 모두 합하면 클래스c에 대한 클래스 활성화 맵을 계산

???
W-c_k는 FC에서 GAP이후로 나온 값에 해당클래스로 가는 가중치를 의미하나?

495p
코드